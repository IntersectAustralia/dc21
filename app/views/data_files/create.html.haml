- content_for :breadcrumb  do
  %h1 Data / Upload

.container
  .alert.alert-success 
    Your files have been uploaded. Below you can modify the information about individual files if you wish.
  = form_tag(bulk_update_data_files_path, :method => :put) do
    - puts "Whole Array: #{@uploaded_files.inspect}"
    - @uploaded_files.each do |file|
      - puts "File: #{file.inspect}"
      .file-panel{:id => "file_panel_#{file.id}"}
        %h2= file.filename
        %ul
          - if file.messages.is_a? Array
            - file.messages.each do |message_attrs|
              -#%i.icon-info-sign
              %li.alert{:class => message_attrs[:type]}= message_attrs[:message]
        .control-group
          %label.control-label Type:
          .controls
            .record= "#{file.file_processing_status}"

        .control-group
          = label_tag "file_#{file.id}_experiment", "Experiment", class: "control-label"
          .controls
            = select_tag "files[#{file.id}][experiment_id]", option_groups_from_collection_for_select(grouped_experiments_for_select, :experiments, :name, :id, :name, file.experiment_id), :id => "file_#{file.id}_experiment"

        .control-group
          = label_tag "file_#{file.id}_description", "Description", class: "control-label"
          .controls
            = text_area_tag "files[#{file.id}][file_processing_description]", file.file_processing_description, :id => "file_#{file.id}_description"

        .control-group#tags
          = label_tag :tags, "Tags", class: "control-label"
          .controls
            - if tags.empty?
              .record None
            - tags.each do |tag|
              %label.checkbox
                = check_box_tag "files[#{file.id}][tag_ids][]", tag.id, file.tag_ids.include?(tag.id), :id => "file_#{file.id}_tag_#{tag.id}"
                = label_tag "file_#{file.id}_tag_#{tag.id}", tag.name

        .control-group
          = label_tag "file_#{file.id}_start_time", "Start Date", class: "control-label"
          .controls
            = text_field_tag "files[#{file.id}][start_time]", @start_time, :id => "file_#{file.id}_start_time", :datepicker => true

        .control-group
          = label_tag "file_#{file.id}_end_time", "End Date", class: "control-label"
          .control
            = text_field_tag "files[#{file.id}][end_time]", @end_time, :id => "file_#{file.id}_end_time", :datepicker => true

    .form-actions
      .actions
        = submit_tag "Update"
